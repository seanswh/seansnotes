Ray Trace——阴影和反射![](/Computer_Graphics/images/44.PNG)

**阴影：**从相机向圆柱投射一条光线。现在，为了找到阴影，我需要从那里向光源投射一条射线。在这个例子中（最上面的绿线），这条阴影检测线（shadow ray）射到光源与之相交，因此它没有被阻挡，所以物体对于光源是可见的。这是另一个像素（下面的绿线），从相机出发经过该像素的光线交到了地面。同样的我向光源投射一条光线。但是这一次它碰到了圆柱。因此它到光源是被阻挡的，从而是在阴影中。

**镜面反射和折射，光线追踪算法**：

![](/Computer_Graphics/images/46.PNG)这次我在镜面反射方向投射一条光线\(上图\)，对于折射也是同样的，遵循斯涅尔定律（Snell's Law，即折射定律）投射。在光线与之相交的地方我得到了背景颜色。

![](/assets/45.PNG)

如上图所示，这就是反射的结果。

Turner Whitted的递归的光线追踪算法：



对于每一个像素，你先追踪从视点发出的主光线（primary eye ray），于是得到了该主光线与场景的交点，注意我在这里使用的术语。从视点发出的光线叫主光线（primary ray），然后我们追踪二次光线（在反射/折射方向上的光线）或者阴影检测线。你可以对每个光源追踪一条阴影检测线。如果光源是可见的，颜色就对应于光照模型的效果，例如Blinn Phong模型和Lambertian漫反射模型。如果阴影检测线被阻挡，则没有来自光源的直接光照。这里使用了+= 操作符。颜色等于表面的反射率乘以反射光线的颜色。这里，递归的光线追踪就开始发挥作用了。因为我们知道颜色等于颜色加上反射率乘以反射光线的颜色，为了求反射光线的颜色，你就要继续追踪光线。

