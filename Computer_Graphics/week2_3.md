(1)光照和着色
研究光照和着色的主要目的是更加逼近于真实世界的情况，物体表面的颜色的总和以及总光照强度。
1.光源
  光的衰减公式为：$$\frac{1}{k_c+K_lD+K_qD^2}$$,其中，D为到光源的距离
  当光源为一个点时，$$k_c=0,k_l=0,k_q=1$$
  当光源为一条线（一个管道）时，$$k_c=0,k_l=1,k_q=0$$
  当光源位置非常远，光线近似于平行方向时，该光称为定向光(directional source)，这个光源用4维向量表示时，w=0，表示为无穷远，而且此光源不衰减（比如太阳光），$$k_c=01,k_l=0,k_q=0$$
2.材质，也就是该物体是如何反射光线的？
    一个面如何反射光？为此需要知道面的法向。对于光照计算来说，得到面的朝向或是法向非常关键，它们影响漫反射、镜面反射；它们影响光源的发射方向，你常常需要找到反射方向。
标准的做法，是设定好每个顶点的法向，然后在每个片元上进行插值。在某些情况下，对于过程模型（procedural model），对每个顶点的法向，也许会有一个解析式，比如球面。对于像茶壶、球等用GLUT定义的物体，GLUT会自动帮你计算好法向。

光源分成以下几种：
  1）发射光：发射光实际对应于太阳光等光源。它实际对应于你直接看向光源时它们发射出的光，而不是你从它的反射方向或其他方向看到的。在OpenGL中，有一点需要明白，就是真想看到光源本身，仅仅创建光源是不够的，你必须构建光源的几何。因为只有几何物体才能被你看到。几何物体被光源照亮，但其实你并没有看到光源，你也看不到相机。
  2）环境光Ambient：是由光源发出经环境多次散射而无法确定其入射方向的光，即光来自所有方向。直观地说就是，即使没有光直接照射到表面，仍然有光在屋内来回反射，并且产生了漫反射或环境光的感觉。如果你进入一个屋子，它一般被大光源照亮，光在墙壁间来回反射，等等。这实际上比较简单，因为模拟场景中光的实际分布是可能的。这在图形学中是一个很广阔的领域，叫全局光照。最终它的分布就是，来自各方向的光近似相等，所以我们给场景一个全局常数，带来的优点是，我真的可以看到我的计算机图形图像，不会有全黑的像素。所以你给整个场景赋一个环境光强度，一般来说它很小，0.1，0.2的样子。
  3）漫射光Diffuse：。对应着粗糙不光滑的表面，在计算机图形学中，我们一般把它们称为Lambertian表面。一旦它照射到物体上，则在各个方向上均匀地发散出去，效果为无论视点在哪里它都一样亮，其特征是入射方向唯一、出射方向为任意方向。漫反射光强调了光线照射到物体表面的角度与物体被照亮程度的关系。物体有光照射的一面比另一面（不直接面向光源的一面）更亮。该光源的一个特征是cosine衰减，也即光线入射方向与法线的cosine值，同时取它和0之间更大的那个。所以我们可以把方程写成这样，对场景中的全部光源求和。
  ![](/Computer_Graphics/images/33.png)
  光源的强度，乘以材料的漫反射系数，乘以对该光源的衰减，乘以L·N和0之间较大的值。这就是漫反射，或者叫Lambertian项。
  4）镜面光Specular：来自特定方向并沿另一方向反射出去，一个平行激光束在高质量的镜面上产生100%的镜面反射，其特征是入射方向和出射方向均唯一。镜面反射光相对于光本身更强调是物体的属性。当光线以特定的角度照射物体时，反射光使物体的某一部分闪光，而观察者只有从特定的方向看过去才能看见这个闪光。回到Phong光照模型的这页幻灯片，它展示了镜面或光滑材质上的Phong照明模型![](/Computer_Graphics/images/34.png)你可以把它看做是光源的模糊反射，如果增强粗糙度，你能够得到更模糊的反射效果。
  Phong的想法是，他想找到一个简单的方法来处理基于观察位置上的高光，类似于漫射光，选择视线和反射光线之间的点积，除此之外，给cosine项增加指数来控制表面到底有多光泽，高光到底有多亮。还有一种替代方法，取光源、视线之间的角度的一半，然后求它和法向的点积。这样它更加接近标准的漫反射光照，漫反射光照中是光线和法向的点积，这个是半角和法向的点积，并且再一次地，你可以增加它的指数。这就是Blinn-Phong模型，实际上，对于物理表面来说，半角的形式更为准确。它是标准OpenGL中的形式，也是我要求你们实现的。
   先看Phong方法：问题是需要找到一个数学形式来表示反射方向R![](/Computer_Graphics/images/35.png)
   首先看光照方向。我打算把它分为水平和竖直两个分量，所以竖直分量是沿着法向的，反射后水平分量其实并没有变，而竖直分量却改变了，这实质上就是反射。所以我们可以用原来的入射光线，它有水平、竖直两个分量，我们要做的就是把沿着法向的竖直分量翻转过来。所以你考虑这个沿着法向的分量，然后通过把它减两次，使它翻转过来。这个分量就是光线和法向的点积。![](/Computer_Graphics/images/36.png)
   再看Blinn-Phong方法：只要使用入射光线和视觉方向，取它们之间的半角，也就是H。如果它们是标量，就等于 (L + E) / 2。归一化后可写成：$$H = \frac{L+E}{|| L + E ||}$$,最后可以把漫反射的公式改写成：
   ![](/Computer_Graphics/images/37.png)公式还有一个控制波瓣尖锐程度的额外的系数 shininess（光泽度）项。所以，如果光泽度非常大，那么反射就集中在
半角方向和镜面方向。如果光泽度是0，那么它和Lambertian（漫反射）的情况就很像了，除了这里使用的是半角，而不是漫反射使用的光源方向。
   最后，一定要注意both light and view directions point **TO** the light or viewer (and away from the surface). The signs on some formulas, such as for the reflection vector R, would be different if L pointed toward the surface instead.

